---
title: "open-format-forest-height"
output: html_document
date: "2023-08-30"
---

```{r, message=FALSE}
library(terra)
library(sf)
library(ggplot2)
library(ggspatial)
library(tidyterra)
library(rgeos)
library(data.table)
library(DT)
library(lubridate)
library(xts)
```

```{r}
input_path <- "../input/"
```

Open raw file of forest height on US 

```{r}
forest <- rast("../input/US_forest_height_2019.tif")
crs(forest)
```

Extract NC borders

```{r}
nc_poly <- paste0("NC_county_boundary/",
                  "North_Carolina_State_and_County_Boundary_Polygons.shp")
nc_borders <- vect(paste0(input_path, nc_poly))
nc_borders <- project(nc_borders, crs(forest))
nc_forest <- terra::crop(forest, nc_borders)
```

Project on "EPSG:5070"

```{r}
nc_forest_proj <- project(nc_forest, "EPSG:5070")
```

Save all final files

```{r}
writeRaster(nc.forest,
            filename = "../input/NC_forest_height_2019_crs-wgs84.tif",
            overwrite = TRUE)
writeRaster(nc_forest_proj,
            filename = paste0("../input/NC_forest_height_2019_albers.tif"),
            overwrite = TRUE)
```

